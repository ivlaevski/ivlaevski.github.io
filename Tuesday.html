<!DOCTYPE html>
<html lang="en">
<head>
  <title>Ти избираш - Детски летен лагер Блага Вест 2019</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <style>
    .bg-purple {
      background-color: #6f42c1;
    }

    .bg-green {
      background-color: #459418;
    }

    .bg-team1 {
      background-color: #db6e15;
    }

    .bg-team2 {
      background-color: #088018;
    }

    .bg-team3 {
      background-color: #db1568;
    }

    .bg-team4 {
      background-color: #3724e0;
      color: white;
    }


    body {
      margin: 0;
    }

    .top-container {
      background-color: #f1f1f1;
      padding: 30px;
      text-align: center;
    }

    .header {
      padding: 10px 16px;
      background: #555;
      color: #f1f1f1;
    }

    .content {
      padding: 16px;
    }

    .sticky {
      position: fixed;
      top: 0;
      width: 100%;
    }

    .sticky+.content {
      padding-top: 102px;
    }

    .widthForTime {
      width: 175px;
      margin-right: 10px;
    }

    .widthForTimer {
      width: 275px;
      margin-right: 10px;
    }

    .timerset {}
  </style>
</head>

<body>

  <script>
    var today = 'Tuesday';
    var dayOfWeek = "Вторник";
    var theme = "Избор между Бога и богаството - богатия младеж";
    var teams = [
       { position: 1, color:"bg-team1", name:"Team 1", game1:"--", game2:"--", total:"0" },
       { position: 2, color:"bg-team2", name:"Team 2", game1:"--", game2:"--", total:"0" },
       { position: 3, color:"bg-team3", name:"Team 3", game1:"--", game2:"--", total:"0" },
       { position: 4, color:"bg-team4", name:"Team 4", game1:"--", game2:"--", total:"0" }
    ];
    var timers = [
      { id: "pos1", hour: 7, min: 30, label: "Ставане" },
      { id: "pos2", hour: 7, min: 45, label: "Гимнастика" },
      { id: "pos3", hour: 8, min: "00", label: "Закуска" },
      { id: "pos4", hour: 8, min: 30, label: "Молитва" },
      { id: "pos5", hour: 8, min: 45, label: "Подготовка за плаж" },
      { id: "pos6", hour: 9, min: "00", label: "Плаж" },
      { id: "pos7", hour: 12, min: "00", label: "Прибиране" },
      { id: "pos8", hour: 13, min: "00", label: "Обяд" },
      { id: "pos9", hour: 14, min: "00", label: "Обедна почивка" },
      { id: "pos10", hour: 15, min: 30, label: "Ставане" },
      { id: "pos11", hour: 16, min: "00", label: "Урок" },
      { id: "pos12", hour: 17, min: "00", label: "Пиеса" },
      { id: "pos13", hour: 17, min: 30, label: "Игри" },
      { id: "pos14", hour: 18, min: 45, label: "Подготовка за вечерята" },
      { id: "pos15", hour: 19, min: "00", label: "Вечеря" },
      { id: "pos16", hour: 19, min: 45, label: "Служба" },
      { id: "pos17", hour: 20, min: 30, label: "Вечерни игри" },
      { id: "pos18", hour: 22, min: 15, label: "Прибиране на малките" },
      { id: "pos19", hour: 23, min: "00", label: "Гасене на лампите" }
    ];
    var dayNames = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
  </script>

  <div class="jumbotron text-center my-0 top-container text-black-50">
    <div class="lh-100">
      <h1 class="mb-0 lh-100">Ти избираш</h1>
      <p>Детски летен лагер Блага Вест 2019</p>
    </div>
  </div>

  <div class="header" id="myHeader" style="z-index: 100">
    <div class="jumbotron text-center p-3 my-3 text-white-50 bg-green rounded shadow-sm">
      <div class="lh-100">
        <h2 class="mb-0 text-white lh-100" id="dayOfWeekLabel">--</h2>
        <h3 class="mb-0 text-white lh-100" id="themeLabel">--</h3>
      </div>
    </div>
    <div class="row team-items">
      
    </div>
  </div>

  <div class="container">
    <div class="list-items">

    </div>
  </div>

  <script type="text/template" data-template="listitem">
      <div class="jumbotron d-flex align-items-center p-3 my-3 text-white-50 bg-info rounded shadow-sm" id="${id}">
        <div class="container">
          <div class="row text-white">
            <div class="col-1 text-center">${hour}:${min}</div>
            <div class="col">${label}</div>
            <div class="col-2 text-right timerset">--</div>
          </div>
        </div>
      </div>
  </script>

  <script type="text/template" data-template="teamitem">
    <div class="text-center shadow-sm col-sm-3" style="margin-top: ${position}0px">
      <div class="align-items-center p-3 rounded ${color}">
        <h4>${name}</h4>
      </div>
      <p></p>
      <p> Плаж: ${game1} точки</p>
      <p>Лагер: ${game2} точки</p>
      <hr />
      <p class="btn btn-warning">Общо: ${total} точки</p>
    </div>
  </script>

  <script>
    

    window.onscroll = function () { myFunction() };

    var header = document.getElementById("myHeader");
    var sticky = header.offsetTop;

    function myFunction() {
      if (window.pageYOffset > sticky) {
        header.classList.add("sticky");
      } else {
        header.classList.remove("sticky");
      }
    }
    function render(props) {
      return function (tok, i) { return (i % 2) ? props[tok] : tok; };
    }

    function zeroPad(num, places) {
      var zero = places - num.toString().length + 1;
      return Array(+(zero > 0 && zero)).join("0") + num;
    }

    var teamTpl = $('script[data-template="teamitem"]').text().split(/\$\{(.+?)\}/g);   
    var itemTpl = $('script[data-template="listitem"]').text().split(/\$\{(.+?)\}/g);
    
    $("#dayOfWeekLabel").text(dayOfWeek);
    $("#themeLabel").text(theme);

    $('.list-items').append(timers.map(function (item) {
      return itemTpl.map(render(item)).join('');
    }));
    $('.team-items').append(teams.map(function (item) {
      return teamTpl.map(render(item)).join('');
    }));

    var x = setInterval(function () {
      var now = new Date();
      var first = true;
      timers.forEach(element => {
        var countDownDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), element.hour, element.min, 0, 0);
        var distance = countDownDate.getTime() - now.getTime() + (1000 * 60 * 60 * 2) - (31 * 60 * 1000);
        if (distance < 0) {
          $("#" + element.id).addClass("bg-secondary");
          $("#" + element.id).removeClass("bg-success");
          $("#" + element.id).removeClass("bg-info");
          $("#" + element.id + " > div > div > div:nth-child(3)").text("--");
        } else {
          var days = Math.floor(distance / (1000 * 60 * 60 * 24));
          var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          var seconds = Math.floor((distance % (1000 * 60)) / 1000);
          if (first) {
            first = false;
            $("#" + element.id).addClass("bg-success");
            $("#" + element.id).removeClass("bg-info");
            $("#" + element.id).removeClass("bg-secondary");
            $("#" + element.id + " > div > div > div:nth-child(3)").text(zeroPad(hours, 2) + ":" + zeroPad(minutes, 2) + ":" + zeroPad(seconds, 2));
            $("#" + element.id).get(0).scrollIntoView();
          }
        }

        var dayofweek = dayNames[ now.getDay() ];
        if (dayofweek !== today) {
          window.location.replace(dayofweek + ".html");
        }
      });
    }, 1000);
  </script>
</body>

</html>